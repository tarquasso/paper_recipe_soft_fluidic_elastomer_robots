%test 1: compliance of fluid
V1 = -[0, 1, 2, 3, 4, 5, 6, 7, 8];
P1 = [0, 2275.2675, 6687.9075, 11583.18, 16823.19, 22270.0425, 28889.0025, 35921.6475, 43781.6625];
Cf = -2.006*10^(-10);

% %test 2: compliance of fluid and actuator
% V2_1 = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
% P2_1 = [0, 3240.5325, 6756.855, 10342.125, 13513.71, 16616.3475, 19787.9325, 22407.9375, 24614.2575, 26613.735];
% Cc_1 = 3.17*10^(-10);
% 
% V2_2 = [10, 11, 12, 13, 14, 15, 16, 17, 18, 19];
% P2_2 = [28061.6325, 29371.635, 30267.9525, 31026.375, 31715.85, 32336.3775, 32887.9575, 33577.4325, 34060.065, 34473.75];
% Cc_2 = 1.426*10^(-9);
% Cc_2_off = -3.083*10^(-5);

%test 3: compliance of channels with incompressible fluids
PASCAL_PER_VOLT = (15.0/4.0)*6894.75729 % [Pa/V] for the pressure transducer
volume_3 = [(0:0.5:12), 13, 14, 15, 16, 17]*10^(-6); %[m^3]
pressure_voltage_3 = [0.531, 0.850, 1.02, 1.15, 1.23, 1.30, 1.35, 1.38, 1.43, 1.44, 1.45, 1.45, 1.45, 1.47, 1.47, 1.47, 1.48, 1.47, 1.47, 1.48, 1.49, 1.48, 1.49, 1.51, 1.51, 1.52, 1.53, 1.55, 1.55, 1.56];
pressure_3 = (pressure_voltage_3 - pressure_voltage_3(1))*PASCAL_PER_VOLT; % [kPa]
Cc_1 = 1.250*10^(-10);
Cc_2 = 4.147*10^(-9);
Voff = -9.280*10^(-5);
%%%%%%%%%%%%%%%%%%%%%%%%%

figure;
hold on;
plot(P1, V1*10^(-6), 'ok')
plot([0 P1(end)], [0 P1(end)*Cf], '-k');

plot(pressure_3, volume_3, 'ok')
plot([0, pressure_3(8)], [0, pressure_3(8)*Cc_1], '-k');
plot([pressure_3(9), pressure_3(end)], [pressure_3(9)*Cc_2+Voff, pressure_3(end)*Cc_2+Voff], '-k');

% plot(P2_1, V2_1*10^(-6), 'xk')
% plot([0 P2_1(end)], [0 P2_1(end)*Cc_1], '-k');
% 
% plot(P2_2, V2_2*10^(-6), '+k')
% plot([P2_2(1), P2_2(end)], [P2_2(1)*Cc_2+Cc_2_off, P2_2(end)*Cc_2+Cc_2_off], '-k');